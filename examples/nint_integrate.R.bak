devtools::load_all('../docopulae')

s = nint_space(nint_scatDim(1:3),
               nint_gridDim(11:13),
               list(nint_scatDim(4:6), nint_gridDim(5:7)),
               list(list(nint_gridDim(14:16)), nint_scatDim(7:9)),
               list(nint_intvDim(21, 23), list(nint_intvDim(24, 26))))
s
nint_validateSpace(s)

ss = nint_expandSpace(s)
ss

ss[[1]]
nint_ispace(ss[[1]])


s = nint_space(nint_scatDim(c(1, 2)),
               nint_gridDim(c(3, 4)),
               #nint_intvDim(0, 1),
               nint_scatDim(c(5, 6)),
               nint_gridDim(c(7, 8)))
s

r = ((1 + 5) + (2 + 6)) * 4 + (3 + 4 + 7 + 8)*2 * 2
r
nint_integrate(sum, s)


s = nint_space(nint_scatDim(c(0, 1)), nint_intvDim(0, 1))
nint_integrate(sum, s) # 1/2 + (1 + 1/2) = 2

s = nint_space(nint_intvDim(0, 2), nint_intvDim(0, 3))
nint_integrate(sum, s) # 3*(2**2 / 2) + 2*(3**2 / 2) = 15

s = nint_space(nint_intvDim(0, 1), nint_funcDim(function(x) nint_intvDim(0, x[1])))
s # triangle
nint_integrate(function(x) 1, s) # 0.5

s = nint_space(nint_intvDim(-1, 1),
               nint_funcDim(function(x) nint_intvDim(c(-1, 1) * sin(acos(x[1])) )) )
s # a circle
nint_integrate(function(x) 1, s) # pi

s = nint_space(s[[1]], s[[2]],
               nint_funcDim(function(x) { r = sin(acos(x[1])); nint_intvDim(c(-1, 1) * r*cos(asin(x[2] / r))) }))
s # a sphere
nint_integrate(function(x) 1, s) # 4*pi/3


s = nint_space(nint_intvDim(1, Inf), nint_intvDim(1, Inf))
nint_integrate(function(x) 1/prod(x ** 2), s, transformInf=T)

s = nint_space(nint_intvDim(-Inf, -1), nint_intvDim(-Inf, -1))
nint_integrate(function(x) 1/prod(x ** 2), s, transformInf=T)

s = nint_space(nint_intvDim(-Inf, Inf))
tt = nint_transformInf(dnorm, nint_ispace(s))
x = seq(-1, 1, length.out=1001)
plot(x, sapply(x, tt$f), type='l')

nint_integrate(dnorm, s, transformInf=T)
nint_integrate(tt$f, ispaces=list(tt$ispace), transformInf=T)

s = nint_space(nint_intvDim(-Inf, Inf), nint_intvDim(-Inf, Inf))
nint_integrate(function(x) prod(dnorm(x, mean=c(3, 7), sd=c(2, 13))), s, transformInf=T)




